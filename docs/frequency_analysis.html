<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Análise Hidrológica com R: uma introdução para iniciantes: Análise de frequência de cheias</title>

  <meta property="description" itemprop="description" content="Exemplo de análise local com dados reais"/>

  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>


  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Análise Hidrológica com R: uma introdução para iniciantes: Análise de frequência de cheias"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Exemplo de análise local com dados reais"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Análise Hidrológica com R: uma introdução para iniciantes"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Análise Hidrológica com R: uma introdução para iniciantes: Análise de frequência de cheias"/>
  <meta property="twitter:description" content="Exemplo de análise local com dados reais"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description"]}},"value":[{"type":"character","attributes":{},"value":["Análise de frequência de cheias"]},{"type":"character","attributes":{},"value":["Exemplo de análise local com dados reais"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        if ($(this).children()[0].nodeName == "D-FOOTNOTE") {
          var fn = $(this).children()[0]
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Análise de frequência de cheias","description":"Exemplo de análise local com dados reais","authors":[]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">Análise Hidrológica com R: uma introdução para iniciantes</a>
</div>
<div class="nav-right">
<a href="index.html">Home</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Aulas
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="conc_basic_R.html">Conceitos básicos R</a>
<a href="get_data.html">Obtenção de dados</a>
<a href="data_manip.html">Manipulação de dados</a>
<a href="data_explore.html">Análise exploratória</a>
<a href="frequency_analysis.html">Análise de frequência</a>
</div>
</div>
<a href="colaboradores.html">Colaboradores</a>
<a href="https://github.com/DirceuReis/Mini_Curso_UnB_SemUniv_AnaliseHidro_R" aria-label="Link to source">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Análise de frequência de cheias</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p>Exemplo de análise local com dados reais</p>
</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#objetivos-da-atividade"
id="toc-objetivos-da-atividade">Objetivos da atividade</a></li>
<li><a href="#seleção-das-vazões-máximas-anuais"
id="toc-seleção-das-vazões-máximas-anuais">Seleção das vazões máximas
anuais</a>
<ul>
<li><a href="#obtenção-da-série-de-vazões-diárias"
id="toc-obtenção-da-série-de-vazões-diárias">Obtenção da série de vazões
diárias</a></li>
<li><a href="#extração-da-série-de-vazões-máximas-anuais"
id="toc-extração-da-série-de-vazões-máximas-anuais">Extração da série de
vazões máximas anuais</a></li>
<li><a href="#visualização-da-série-de-máximos-anuais"
id="toc-visualização-da-série-de-máximos-anuais">Visualização da série
de máximos anuais</a></li>
</ul></li>
<li><a href="#construção-da-curva-de-frequência-amostral"
id="toc-construção-da-curva-de-frequência-amostral">Construção da curva
de frequência amostral</a>
<ul>
<li><a href="#posição-de-plotagem" id="toc-posição-de-plotagem">Posição
de plotagem</a></li>
</ul></li>
<li><a href="#ajuste-de-uma-distribuição-teórica-de-probabilidades"
id="toc-ajuste-de-uma-distribuição-teórica-de-probabilidades">Ajuste de
uma distribuição teórica de probabilidades</a>
<ul>
<li><a href="#a-distribuição-lognormal"
id="toc-a-distribuição-lognormal">A distribuição lognormal</a></li>
<li><a href="#quantis-de-cheia-da-lognormal"
id="toc-quantis-de-cheia-da-lognormal">Quantis de cheia da
lognormal</a></li>
<li><a href="#método-de-ajuste" id="toc-método-de-ajuste">Método de
ajuste</a></li>
<li><a href="#ajuste-da-lognormal-e-estimativa-dos-quantis"
id="toc-ajuste-da-lognormal-e-estimativa-dos-quantis">Ajuste da
lognormal e estimativa dos quantis</a></li>
<li><a href="#determinação-dos-quantis-de-cheia"
id="toc-determinação-dos-quantis-de-cheia">Determinação dos quantis de
cheia</a></li>
</ul></li>
<li><a href="#descrição-das-incertezas"
id="toc-descrição-das-incertezas">Descrição das incertezas</a>
<ul>
<li><a
href="#lógica-da-construção-de-intervalos-de-confiança-aproximados"
id="toc-lógica-da-construção-de-intervalos-de-confiança-aproximados">Lógica
da construção de intervalos de confiança aproximados</a></li>
</ul></li>
<li><a href="#inferência" id="toc-inferência">Inferência</a>
<ul>
<li><a href="#cálculo-dos-momentos-l"
id="toc-cálculo-dos-momentos-l">Cálculo dos momentos-L</a></li>
<li><a href="#diagrama-de-momentos-l"
id="toc-diagrama-de-momentos-l">Diagrama de momentos-L</a></li>
<li><a href="#estimativa-dos-parâmetros-da-distribuição"
id="toc-estimativa-dos-parâmetros-da-distribuição">Estimativa dos
parâmetros da distribuição</a></li>
<li><a href="#cálculo-dos-quantis-de-cheia"
id="toc-cálculo-dos-quantis-de-cheia">Cálculo dos quantis de
cheia</a></li>
</ul></li>
<li><a href="#construção-da-curva-de-frequência"
id="toc-construção-da-curva-de-frequência">Construção da curva de
frequência</a></li>
<li><a href="#descrição-das-incertezas-intervalo-de-confiança"
id="toc-descrição-das-incertezas-intervalo-de-confiança">Descrição das
incertezas (intervalo de confiança)</a></li>
<li><a href="#curva-de-frequência-final"
id="toc-curva-de-frequência-final">Curva de frequência final</a></li>
<li><a href="#detalhes-técnicos" id="toc-detalhes-técnicos">Detalhes
técnicos</a>
<ul>
<li><a href="#distribuição-de-probabilidades"
id="toc-distribuição-de-probabilidades">Distribuição de
probabilidades</a></li>
</ul></li>
<li><a href="#detalhamento-de-posição-de-plotagem"
id="toc-detalhamento-de-posição-de-plotagem">Detalhamento de posição de
plotagem</a></li>
<li><a href="#passos-a-serem-executados"
id="toc-passos-a-serem-executados">Passos a serem executados</a></li>
</ul>
</nav>
</div>
<h2 id="objetivos-da-atividade">Objetivos da atividade</h2>
<p>O objetivo desta atividade é realizar uma análise de frequência de
cheias a nível local. Isso significa que iremos relacionar a magnitude
das vazões máximas anuais com a probabilidade da mesma ser excedida. A
análise a nível local siginifca que utilizaremos apenas as informações
de vazão observadas na estação fluviométrica de interesse, sem fazer uso
de informações sobre as vazões máximas anuais que teham acontecido em
outras estações fluviométricas localizadas na região.</p>
<p>Além de construirmos a relação entre a magnitude das vazões máximas
anuais e a respectiva probabilidade de excedência, é importante saber
estimar também o grau de incerteza nessas estimativas. Essas incertezas
são usualmente representadas por intervalos de confiança, como veremos
mais adianate.</p>
<p>Além de calcular essas quantidades, a curva de frequência, e suas
respectivas incertezas, são representadas graficamente, como na figura
abaixo, que mostra os resultados para um estudo de cheias numa seção do
Rio Salado, localizada na província de Santa Fé, na Argentina, onde em
2003 ocorreu o rompimento de um dique que resultou em perde de vidas
humanas e elevados prejuízos.</p>
<p>Contruiremos aqui no curso uma figura semelhante a esta, onde no
eixo-x temos o tempo de recorrência e no eixo-y a magnitude das vazões
máximas anuais. O tempo de recorrência apresentado no eixo-x é uma
maneira de representar a probabilidade de excedência. A linha cheia em
vermelho representa o valor esperado dos valores da vazão máxima anual
em função do tempo de recorrência, enquanto as linhas tracejadas
representam os intervalos de confiança de 95%, ilustrando as incertezas
envolvidas nessas estimativas. Os círculos azuis escuros representam as
vazões máximas anuais registradas no passado, enquanto o círculo azul
claro mostra a cheia destruidora de 2003.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center">
<img src="images/curva_freq_salado.png" alt="Curva de frequência do cheias do Rio Salado, na Argentina." width="90%" />
<p class="caption">
(#fig:curva_freq)Curva de frequência do cheias do Rio Salado, na
Argentina.
</p>
</div>
</div>
<h2 id="seleção-das-vazões-máximas-anuais">Seleção das vazões máximas
anuais</h2>
<p>O primeiro passo de nossa atividade consiste em obter a série de
máximos anuais que desejamos analisar. A obtenção da série de máximos
anuais será realizada em duas etapas. Primeiro vamos obter a séries de
vazões diárias, e para isso utilizaremos a mesma função de obtenção de
séries diárias de vazão que aprendemos na segunda aula deste curso. Com
a série de vazões diárias em mãos, passaremos para a segunda etapa, que
é a de extrair a vazão máxima de cada ano hidrológico.</p>
<h3 id="obtenção-da-série-de-vazões-diárias">Obtenção da série de vazões
diárias</h3>
<p>A função abaixo permite obter a série de vazões diárias de uma
estação fluviométrica. O único argumento desta função é o código da
estação. Quando chamamos esta função, ela retorna um dataframe com 3
colunas: o código da estação, a data, e o valor da vazão diária.</p>
<p>Como já estudamos esta função anteriormente, a uitlizaremos aqui sem
entrar em qualqer detalhes sobre seu funcionamento.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Função para obter série histórica de vazão de uma determinada estação ####</span></span>
<span><span class='va'>dados_serie_ANA</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>cod_estacao</span> <span class='op'>=</span> <span class='cn'>NA</span>,</span>
<span>                            <span class='va'>data_inicio</span> <span class='op'>=</span> <span class='st'>"01/01/1800"</span>,</span>
<span>                            <span class='va'>data_fim</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.Date</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>                            <span class='va'>tipo_dados</span> <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>                            <span class='va'>nivel_consist</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  </span>
<span>  <span class='co'># Pegar dados a partir do url e transformar em um dataframe</span></span>
<span>  <span class='va'>url_base</span> <span class='op'>&lt;-</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"http://telemetriaws1.ana.gov.br/ServiceANA.asmx/"</span>,</span>
<span>           <span class='st'>"HidroSerieHistorica?"</span>,</span>
<span>           <span class='st'>"codEstacao="</span>, <span class='va'>cod_estacao</span>,</span>
<span>           <span class='st'>"&amp;dataInicio="</span>, <span class='va'>data_inicio</span>,</span>
<span>           <span class='st'>"&amp;dataFim="</span>, <span class='va'>data_fim</span>,</span>
<span>           <span class='st'>"&amp;tipoDados="</span>, <span class='va'>tipo_dados</span>,</span>
<span>           <span class='st'>"&amp;nivelConsistencia="</span>, <span class='va'>nivel_consist</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='va'>url_parse</span> <span class='op'>&lt;-</span> <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/xmlTreeParse.html'>xmlParse</a></span><span class='op'>(</span><span class='va'>url_base</span>, encoding <span class='op'>=</span> <span class='st'>"UTF-8"</span><span class='op'>)</span></span>
<span>  <span class='va'>node_doc</span> <span class='op'>&lt;-</span> <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/getNodeSet.html'>getNodeSet</a></span><span class='op'>(</span><span class='va'>url_parse</span>, <span class='st'>"//SerieHistorica"</span><span class='op'>)</span></span>
<span>  <span class='va'>dados_estacao</span> <span class='op'>&lt;-</span> <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/xmlToDataFrame.html'>xmlToDataFrame</a></span><span class='op'>(</span>nodes <span class='op'>=</span> <span class='va'>node_doc</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='co'># Por algum motivo o hidroweb não está filtrando os dados pela consistencia</span></span>
<span>  <span class='va'>dados_estacao</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>dados_estacao</span>, <span class='va'>NivelConsistencia</span> <span class='op'>==</span> <span class='va'>nivel_consist</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='co'># Separar data e hora</span></span>
<span>  <span class='va'>dados_estacao</span><span class='op'>$</span><span class='va'>Data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substr</a></span><span class='op'>(</span><span class='va'>dados_estacao</span><span class='op'>$</span><span class='va'>DataHora</span>, <span class='fl'>1</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='va'>dados_estacao</span><span class='op'>$</span><span class='va'>Hora</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substr</a></span><span class='op'>(</span><span class='va'>dados_estacao</span><span class='op'>$</span><span class='va'>DataHora</span>, <span class='fl'>12</span>, <span class='fl'>19</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='co'># Fazer um dataframe só com datas e valores de vazão</span></span>
<span>  <span class='va'>datas_dia</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.Date.html'>seq.Date</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>dados_estacao</span><span class='op'>$</span><span class='va'>Data</span><span class='op'>)</span>,</span>
<span>                        to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>dados_estacao</span><span class='op'>$</span><span class='va'>Data</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/pkg/lubridate/man/mplus.html'>%m+%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/weekday.POSIXt.html'>months</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1</span>,</span>
<span>                        by <span class='op'>=</span> <span class='st'>"day"</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='va'>tabela_final</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Cod_estacao <span class='op'>=</span> <span class='va'>dados_estacao</span><span class='op'>$</span><span class='va'>EstacaoCodigo</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,</span>
<span>                             Data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>datas_dia</span><span class='op'>)</span>,</span>
<span>                             Vazao <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  </span>
<span>  </span>
<span>  <span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>tabela_final</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='co'># Dia em análise</span></span>
<span>    <span class='va'>dia</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substr</a></span><span class='op'>(</span><span class='va'>tabela_final</span><span class='op'>$</span><span class='va'>Data</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='fl'>9</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    </span>
<span>    <span class='co'># Mês e ano em análise</span></span>
<span>    <span class='va'>mes_ano</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substr</a></span><span class='op'>(</span><span class='va'>tabela_final</span><span class='op'>$</span><span class='va'>Data</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='fl'>1</span>, <span class='fl'>8</span><span class='op'>)</span>, <span class='st'>"01"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    </span>
<span>    <span class='co'># Olhar a linha do mes e ano e escolher a coluna pelo dia + 15</span></span>
<span>    <span class='va'>linha_dado</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>dados_estacao</span><span class='op'>$</span><span class='va'>Data</span> <span class='op'>==</span> <span class='va'>mes_ano</span><span class='op'>)</span></span>
<span>    </span>
<span>    <span class='co'># Se não tiver o mês nos dados da estação, colocar valor NA</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>linha_dado</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0</span>,</span>
<span>           <span class='va'>tabela_final</span><span class='op'>$</span><span class='va'>Vazao</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>,</span>
<span>           <span class='va'>tabela_final</span><span class='op'>$</span><span class='va'>Vazao</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span></span>
<span>             <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>dados_estacao</span><span class='op'>[</span><span class='va'>linha_dado</span>, <span class='op'>(</span><span class='va'>dia</span> <span class='op'>+</span> <span class='fl'>15</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    </span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>tabela_final</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<p>Precisamos escolher uma estação fluviométrica para realizar nossa
análise. SUgiro utilizar a estação <strong>60435000</strong>, localizada
na bacia do Rio Descoberto, que drena uma área de <span
class="math inline">\(113.2 km^2\)</span>, mas vocês têm a indepedência
de escolhar qualquer outras estação que esteja no banco de dados da
Agência Nacional de Águas.</p>
<p>Para obter a série diária da estação escolhida, basta chamar a função
acima passando o argumento necessário, que é simplesmente o código da
estação desejada. A função devolve um dataframe com a série de máximos
anuais.</p>
<p>Para fins de visualização, utilizamos a função
<code>head(nome_do_dataframe)</code> do R, como mostrado abaixo, que nos
mostra as primeiras 6 linhas do dataframe.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>dados_60435000</span> <span class='op'>&lt;-</span> <span class='fu'>dados_serie_ANA</span><span class='op'>(</span>cod_estacao <span class='op'>=</span> <span class='fl'>60435000</span><span class='op'>)</span></span>
<span><span class='va'>index_falha_diario</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>dados_60435000</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>==</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>dias_falha</span> <span class='op'>&lt;-</span> <span class='va'>dados_60435000</span><span class='op'>[</span><span class='va'>index_falha_diario</span>,<span class='fl'>2</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>dados_60435000</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>  Cod_estacao       Data Vazao
1    60435000 1978-05-01    NA
2    60435000 1978-05-02    NA
3    60435000 1978-05-03    NA
4    60435000 1978-05-04    NA
5    60435000 1978-05-05    NA
6    60435000 1978-05-06    NA</code></pre>
</div>
<p>Além disso, é sempre importante visualizar os dados para que se teha
uma ideia geral da faixa de variação das vazões, sazonalidade e outras
padrões que possa ser percebidos num gráfico.</p>
<p>Aqui, nós plotaremos a série completa das vazões diárias da estação
<strong>60435000</strong> utilizando o código abaixo, que emprega o
chamado R-base, ao invés de pacote <code>ggplot2</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>time</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='va'>dados_60435000</span><span class='op'>$</span><span class='va'>Data</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>time</span>,<span class='va'>dados_60435000</span><span class='op'>$</span><span class='va'>Vazao</span>,type<span class='op'>=</span><span class='st'>"l"</span>,</span>
<span>     main <span class='op'>=</span> <span class='st'>"Vazões diárias - estação 60435000"</span>,</span>
<span>     xlab <span class='op'>=</span> <span class='st'>"Anos"</span>,ylab <span class='op'>=</span> <span class='st'>"Q (m3/s)"</span><span class='op'>)</span></span>
<span><span class='co'># Adiciona grid horizontal apenas</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/grid.html'>grid</a></span><span class='op'>(</span>nx <span class='op'>=</span> <span class='cn'>NA</span>, ny <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>     lty <span class='op'>=</span> <span class='fl'>2</span>,      <span class='co'># Grid line type</span></span>
<span>     col <span class='op'>=</span> <span class='st'>"gray"</span>, <span class='co'># Grid line color</span></span>
<span>     lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>      <span class='co'># Grid line width</span></span></code></pre>
</div>
<p><img src="frequency_analysis_files/figure-html5/unnamed-chunk-1-1.png" width="768" /></p>
</div>
<p>Pode-se notar que nos seis primeiros dias dos dados, que se inicia em
maio de 1978, não temos valores registrados de vazão.</p>
<h3 id="extração-da-série-de-vazões-máximas-anuais">Extração da série de
vazões máximas anuais</h3>
<p>Com a série de vazões diárias, passamos ao segundo passo que é o de
construir a série de máximos anuais com base no ano hidrológico. Para
isso, utilizaremos uma outra função, que é apresentada abaixo. Veja que
a função internamente considera o ano hidrológico com início no mês de
agosto. O mês de início do ano hidrológico pode ser facilmente alterado,
se for o desejo do analista. Uma outra solução seria reesecrever a
função incluindo como argumento o mês de início do ano hidrológico.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Contrução da série de máximos anuais a partir de um ano hidrológico ####</span></span>
<span><span class='va'>fun_max_ano</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>tabela</span> <span class='op'>=</span> <span class='cn'>NA</span>,</span>
<span>                        <span class='va'>comeco_ano_hidro</span> <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  </span>
<span>  <span class='co'># Transformar a coluna Data em "Dates" (caso esteja em character)</span></span>
<span>  <span class='va'>tabela</span><span class='op'>$</span><span class='va'>Data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='va'>tabela</span><span class='op'>$</span><span class='va'>Data</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='co'># Definir se o mês em questão entra no ano atual ou no próximo ano</span></span>
<span>  <span class='va'>desloc_ano</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/lubridate/man/month.html'>month</a></span><span class='op'>(</span><span class='va'>tabela</span><span class='op'>$</span><span class='va'>Data</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='va'>comeco_ano_hidro</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='co'># Ano Hidro</span></span>
<span>  <span class='va'>tabela</span><span class='op'>$</span><span class='va'>ano_hidro</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/lubridate/man/year.html'>year</a></span><span class='op'>(</span><span class='va'>tabela</span><span class='op'>$</span><span class='va'>Data</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>desloc_ano</span></span>
<span>  </span>
<span>  <span class='co'># Fazer uma tabela final apenas com os máximos anuais</span></span>
<span>  <span class='va'>max_anuais</span> <span class='op'>&lt;-</span></span>
<span>    <span class='va'>tabela</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Cod_estacao</span>, <span class='va'>ano_hidro</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>maxima <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>Vazao</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<p>Para finalmente obtermos a série de máximos anuais, basta chamar a
função fornecendo o arquivo que contém as séries diárias de vazão, que
no nosso caso é o <code>dados_60435000</code>. Mais uma vez, podemos
utilizar a função <code>head</code> para dar uma leve espiada nas
informoações contidas no dataframe.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>Q_max</span> <span class='op'>&lt;-</span> <span class='fu'>fun_max_ano</span><span class='op'>(</span><span class='va'>dados_60435000</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>Q_max</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 6 × 3
# Groups:   Cod_estacao [1]
  Cod_estacao ano_hidro maxima
  &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt;
1 60435000         1978   NA  
2 60435000         1979   16.1
3 60435000         1980   28.9
4 60435000         1981   11.1
5 60435000         1982   12.8
6 60435000         1983   25.3</code></pre>
</div>
<p>A função <code>fun_max_ano</code> foi escrita de forma que qualquer
falha na série de vazões diárias num dado ano hidrológico resulta numa
falha na série de máximos anuais. Isso nem semrpe é necessário, já que
falhas no período de estiagem não indicam falhas nas séries de máximos,
mas creio que a função nos serve bem para este curso.</p>
<p>Podemos notar a presença de um <code>NA</code> na nossa plotagem
acima. É interessante verificar o número total de anos disponíveis com
dados diários de vazão, bem como o número de anos com falaha na série de
máximos anuais.</p>
<p>O número de anos com dados de vazões diárias pode ser obtidos
simplemente identificando o número de linhas no dataframe
<code>Q_max</code>, e para isso utilizamos o código abaixo,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>n_anos</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>Q_max</span><span class='op'>)</span></span>
<span><span class='va'>n_anos</span></span></code></pre>
</div>
<pre><code>[1] 45</code></pre>
</div>
<p>Mas já sabemos que o ano de 1978 não contém o valor de vazão máxima
porque a série de vazões diárias não estava complete. Será que há outros
anos no histórico com esse problema. Para identificar se há falha em
outros anos, utilizaremos duas funções do R de forma conjunta,
<code>is.na</code> e <code>which</code>. A função <code>is.na</code>
identifica se o elemento é um <code>NA</code> ou não, retornando um
valor lógico, <code>TRUE</code> ou <code>FALSE</code>, enquanto a função
<code>which</code> permite identificar a posição de uma dada condição. O
código abaixo permite identificar em quais anos ocorrem falhas na série
de máximos anuais,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Q_max</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>==</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>anos_falha</span> <span class='op'>&lt;-</span> <span class='va'>Q_max</span><span class='op'>[</span><span class='va'>index</span>,<span class='fl'>2</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span></span>
<span><span class='va'>anos_falha</span></span></code></pre>
</div>
<pre><code># A tibble: 3 × 2
  ano_hidro maxima
      &lt;dbl&gt;  &lt;dbl&gt;
1      1978     NA
2      2009     NA
3      2020     NA</code></pre>
</div>
<p>A primeira linha de código identifica as posições em que há a
presença de <code>NA</code> na terceira coluna do dataframe, que é a
coluna com as informações sobre as vazões máximas de cada ano
hidrológico, e associa à variável <code>index</code>. Na linha seguinte,
criamos um novo dataframe com a informação dos anos em que temos falhas
nos dados.</p>
<p>É verdade que poderíamos ter escrito o código acima de uma forma mais
compacta, porém ficaria mais difícil de entender. Veja o que vocÊ
acha?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>anos_falha</span> <span class='op'>&lt;-</span> <span class='va'>Q_max</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Q_max</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>==</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>,<span class='fl'>2</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span></span>
<span><span class='va'>anos_falha</span></span></code></pre>
</div>
<pre><code># A tibble: 3 × 2
  ano_hidro maxima
      &lt;dbl&gt;  &lt;dbl&gt;
1      1978     NA
2      2009     NA
3      2020     NA</code></pre>
</div>
<p>Mais à frente, quando tivermos que fazer os cálculos necessários para
realizar a naálise de frequência, teremos que nos livrar desses anos com
falhas. Mas por enquanto vamos deixá-los ocmo estão, e passemos a etapa
seguinte que é a de visualizar a série de máximos anuais.</p>
<h3 id="visualização-da-série-de-máximos-anuais">Visualização da série
de máximos anuais</h3>
<p>Agora já podemos visualizar a série de máximos anuais que serivirão
de base para a nossa análise de frequência. Essa visaulização pode ser
feita com o código abaixo, que utiliza apenas o <code>R-base</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Q_max</span><span class='op'>$</span><span class='va'>ano_hidro</span>,<span class='va'>Q_max</span><span class='op'>$</span><span class='va'>maxima</span>,type <span class='op'>=</span> <span class='st'>"o"</span>,</span>
<span>     main <span class='op'>=</span> <span class='st'>"Máximos anuais - 60435000"</span>,</span>
<span>     xlab <span class='op'>=</span> <span class='st'>"Anos"</span>,ylab <span class='op'>=</span> <span class='st'>"Q_max (m3/s)"</span>,lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span><span class='co'># Adiciona grid</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/grid.html'>grid</a></span><span class='op'>(</span>nx <span class='op'>=</span> <span class='cn'>NULL</span>, ny <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>     lty <span class='op'>=</span> <span class='fl'>2</span>,      <span class='co'># Grid line type</span></span>
<span>     col <span class='op'>=</span> <span class='st'>"gray"</span>, <span class='co'># Grid line color</span></span>
<span>     lwd <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>      <span class='co'># Grid line width</span></span></code></pre>
</div>
<p><img src="frequency_analysis_files/figure-html5/unnamed-chunk-7-1.png" width="768" /></p>
</div>
<h2 id="construção-da-curva-de-frequência-amostral">Construção da curva
de frequência amostral</h2>
<h3 id="posição-de-plotagem">Posição de plotagem</h3>
<p>Para que possamos plotar os círculos azuis escuros da Figura
apresentada anteriormente, para o caso do Rio Salado, que representam as
vazões máximas anuais observadas na série histórica, precisamos
determinar as chamadas posição de plotagem, que para a referida Figura é
o tempo de recorrência estimado para cada um desses valores.</p>
<p>Para que seja possível entender esta etapa, vale a pena investir um
certo tempo do curso em alguns conceitos básicos.</p>
<p>O tempo de recorrência associado a uma determinada magnitude de
vazão, <span class="math inline">\(T_r(q)\)</span>, é um conceito
hidrológico bastante conhecido, de forma que não dedicaremos muito tempo
para discutí-lo aqui. Por definição, o tempo de recorrência de um
evento, cuja magnitude vale <span class="math inline">\(q\)</span>, é
igual ao inverso da probabilidade da vazão máxima anual exceder esse
valor,</p>
<p><span class="math display">\[T_r(q) =
\frac{1}{P(Q&gt;q)}\]</span></p>
<p>Por exemplo, se a probabilidade da vazão máxima anual ultrapassar um
dado valor <span class="math inline">\(q\)</span> for igual a 0.10,
dizemos que o tempo de recorrência dessa vazão <span
class="math inline">\(q\)</span> é de 10 anos. Da mesma forma, se <span
class="math inline">\(P(Q&gt;q)=0.01\)</span>, dizemos que o tempo de
recorrência de <span class="math inline">\(q\)</span> vale 100 anos.</p>
<p>Portanto, para que possamos incluir as vazões observadas na nossa
curva de frequência, será preciso determinar a probabilidade de
excedência de cada uma das observações contidas na série de vazões
máximas anuais da localidade de interesse. Como o intuito neste primeiro
momento é plotar as vazões observadas na curva de frequência, nos
basearemos na chamada distribuição empírica de frequência.</p>
<p>A distribuição empírica de frequência relaciona cada valor de vazão
máxima observada na série histórica, denominada aqui de <span
class="math inline">\(q_i\)</span>, com sua frequência relativa
acumulada, <span class="math inline">\(\hat{F}_Q(q_i)\)</span>, que
representa a nossa estimativa para a probabilidade da variável de
interesse, <span class="math inline">\(Q\)</span>, ser menor ou igual ao
valor amostral, <span class="math inline">\(q_i\)</span>,</p>
<p><span class="math display">\[\hat{F}_Q(q_i) = \hat{P}(Q \le
q_i)\]</span></p>
<p>em que <span class="math inline">\(\hat{F}_Q\)</span> é a estimativa
da frequência relativa acumulada da variável aleatória <span
class="math inline">\(Q\)</span> baseada na amostra, enquanto <span
class="math inline">\(q_i\)</span> reprenta o valor de uma dada
observação <span class="math inline">\(i\)</span>. O uso do acento
circunflexo na equação acima é uma convenção utilizada em estatística
para mostrar que estamos nos referindo a uma estimativa da grandeza em
questão baseada na amostra que se tem em mãos.</p>
<p>Bem, quando falamos em <span class="math inline">\(T_r(q)\)</span>,
nos referimos à probabilidade de excedência, que é na verdade o
complemento de <span class="math inline">\(\hat{F}_Q(q_i)\)</span>, ou
seja,</p>
<p><span class="math display">\[\hat{P}(Q \gt q_i) = 1 - \hat{P}(Q \le
q_i)\]</span> de forma que</p>
<p><span class="math display">\[\hat{T}_r(q_i) = \frac{1}{1-\hat{P}(Q
\le q_i)}\]</span></p>
<p>Pode parecer estranho se você estiver vendo isso pela primeira vez,
mas a verdade é que há diferentes maneiras de se estimar a distribuição
empírica de frequência das observações de uma amostra,<span
class="math inline">\(\hat{P}(Q\le q_i)\)</span>, ou seu complemento,
<span class="math inline">\(\hat{P}(Q\gt q_i)\)</span>.</p>
<p>Uma maneira bem comum de estimar tais probabilidades, quando se tem
uma amostra de tamanho <span class="math inline">\(n\)</span>, consiste
em ordenar a série em ordem decrescente e determinar a probabilidade de
excedência utilizando a seguinte fórmula,</p>
<p><span class="math display">\[\hat{P}(Q &gt; q_{(i)}) = 1 -
\hat{F}_Q(q_{(i)}) = \frac{i}{n+1}\]</span></p>
<p>em que <span class="math inline">\(q_{(i)}\)</span> representa a
chamada estatística de ordem <span class="math inline">\(i\)</span>, em
que <span class="math inline">\(q_{(1)}\gt q_{(2)}\gt \ldots \gt
q_{(n)}\)</span>, de forma que <span
class="math inline">\(q_{(1)}\)</span> e <span
class="math inline">\(q_{(n)}\)</span> são, respectivamente, a maior e a
menor observações da amostra. De acordo com essa expressão, por exemplo,
numa amostra de tamanho 49, a probabilidade da vazão máxima anual ser
maior do que a maior observação da amostra vale <span
class="math inline">\(P(Q&gt;q_{(1)})=0.02\)</span>), o que resulta num
tempo de recorrência de <span
class="math inline">\(T_r(q_{(1)})=50\)</span> anos.</p>
<p>Não se preocupe tanto se esse conceito de posição de plotagem não
ficou totalmente claro. Basta saber que plotaremos os valores de máximos
anuais da amostra na curva de frequência utilizando a posição de
plotagem de Weibull.</p>
<p>Na verdade, utilizaremos o tempo de recorrência, <span
class="math inline">\(T_r\)</span>, para plotagem, lembrando que o <span
class="math inline">\(T_r\)</span> é simplemenste o inverso da
probabilidade de excedência, representada pela posição de plotagem de
Weibull.</p>
<p>O código para o cálculo do <span class="math inline">\(Tr\)</span> é
apresentado abaixo. Para facilitar a compreenção de como o cálculo é
feito, criaram-se três novas colunas ao dataframe que contém as vazões
máximas anuais. Mas antes disso, efetuou-se o ordenamento das vazões
máximas em ordem decrescente, ou seja, o primeiro valor de vazão da nova
série ordenada é o maior da amostra.</p>
<p>As três novas colunas são, respectivamente, o índice das vazões,
começando de 1 indo até o número total de valores, a posição de plotagem
de Weilbull, que expressa a probabilidade de excedência, e por último o
tempo de recorrência, <span class="math inline">\(Tr\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Remoção dos anos com falha</span></span>
<span><span class='va'>Q_max</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span><span class='op'>(</span><span class='va'>Q_max</span><span class='op'>)</span></span>
<span><span class='co'># Ordenamento decrescente do dataframe</span></span>
<span><span class='va'>Q_max_ord</span> <span class='op'>&lt;-</span> <span class='va'>Q_max</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>Q_max</span><span class='op'>$</span><span class='va'>maxima</span>, decreasing <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, <span class='op'>]</span></span>
<span><span class='co'># Inclusão de Três novas colunas: index, posição de plotagem de Weibull, e Tr</span></span>
<span><span class='va'>Q_max_ord</span><span class='op'>$</span><span class='va'>index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fl'>1</span>,to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>Q_max_ord</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>Q_max_ord</span><span class='op'>$</span><span class='va'>weibull</span> <span class='op'>&lt;-</span> <span class='va'>Q_max_ord</span><span class='op'>$</span><span class='va'>index</span><span class='op'>/</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>Q_max_ord</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span><span class='va'>Q_max_ord</span><span class='op'>$</span><span class='va'>Tr</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>/</span><span class='va'>Q_max_ord</span><span class='op'>$</span><span class='va'>weibull</span></span></code></pre>
</div>
</div>
<p>Como já fizemos antes, podemos dar uma espiada nesse novo dataframe
com as vazões máximas anuais ordenada utilizando a função
<code>head(dataframe_name)</code>,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>Q_max_ord</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 6 × 6
# Groups:   Cod_estacao [1]
  Cod_estacao ano_hidro maxima index weibull    Tr
  &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 60435000         2004   37.5     1  0.0233 43   
2 60435000         1980   28.9     2  0.0465 21.5 
3 60435000         1983   25.3     3  0.0698 14.3 
4 60435000         1994   19.3     4  0.0930 10.8 
5 60435000         2016   17.8     5  0.116   8.6 
6 60435000         1988   17.1     6  0.140   7.17</code></pre>
</div>
<p>A última coluna de <code>Q_max_ord</code> contém o valor do tempo de
recorrência de cada uma das observações contidas na amostra. Vale notar
que as observações em <code>Q_max_ord</code> estão ordenadas em ordem
decrescente.</p>
<p>Podemos agora criar uma Figura, similar àquela apresentada para o
estudo do Rio Salado. Porém, nesta etapa de nossa análise, apenas os
valores amostrais das vazões máximas serão apresentados.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Q_max_ord</span><span class='op'>$</span><span class='va'>Tr</span>,<span class='va'>Q_max_ord</span><span class='op'>$</span><span class='va'>maxima</span>,type <span class='op'>=</span> <span class='st'>"p"</span>, pch <span class='op'>=</span> <span class='fl'>19</span>,cex <span class='op'>=</span> <span class='fl'>1.5</span>,col <span class='op'>=</span> <span class='st'>"blue"</span>,</span>
<span>     log <span class='op'>=</span> <span class='st'>"x"</span>,main <span class='op'>=</span> <span class='st'>"Curva de frequência de cheias - 60435000"</span>,</span>
<span>     xlab <span class='op'>=</span> <span class='st'>"Tr (anos)"</span>,ylab <span class='op'>=</span> <span class='st'>"Q_max (m3/s)"</span>,</span>
<span>     xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>100</span><span class='op'>)</span>,   <span class='co'># X-axis limits</span></span>
<span>     ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># Adiciona grid horizontal</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/axis.html'>axis</a></span><span class='op'>(</span><span class='fl'>1</span>, at <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>10</span>,by<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>100</span>,by<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>200</span>,<span class='fl'>1000</span>,by<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>     tck <span class='op'>=</span> <span class='fl'>1</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='st'>"gray"</span><span class='op'>)</span></span>
<span><span class='co'># Adiciona grid vertical</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/axis.html'>axis</a></span><span class='op'>(</span><span class='fl'>2</span>, tck <span class='op'>=</span> <span class='fl'>1</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='st'>"gray"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="frequency_analysis_files/figure-html5/unnamed-chunk-10-1.png" width="768" /></p>
</div>
<h2 id="ajuste-de-uma-distribuição-teórica-de-probabilidades">Ajuste de
uma distribuição teórica de probabilidades</h2>
<h3 id="a-distribuição-lognormal">A distribuição lognormal</h3>
<p>Se considerarmos que as vazões máximas anuais <span
class="math inline">\((Q)\)</span> possuem uma distribuição lognormal,
então os logaritmos de <span class="math inline">\(Q\)</span>, chamados
aqui de <span class="math inline">\(Y = ln(Q)\)</span>, terão, por
definição, uma distribuição normal,</p>
<p><span class="math display">\[
Y = ln(Q) \sim N(\mu_Y,\sigma_Y^2)
\]</span> o que significa dizer que os logarítmicos das vazões máximas
anuais são bem representados por uma distribuição Normal com parâmetros
<span class="math inline">\(\mu_Y\)</span> e <span
class="math inline">\(\sigma_Y^2\)</span>, que, para quem não lembra,
representam a média e a variância populacionais.</p>
<p>O adjetivo populacional utilizado aqui é para lembrarmos que essas
caracerísticas da distribuição são, na verdade, desconhecidas. A única
pista que temos sobre o valor desses parâmetros está contida na amostra
que temos, formada por um conjunto de vazões máximas anuais. A maneira
que utilizaremos a amostra para tentar compreender essa distribuição é o
assunto da próxima seção.</p>
<h3 id="quantis-de-cheia-da-lognormal">Quantis de cheia da
lognormal</h3>
<p>É muito provável que vocês não se recordem, mas a distribuição Normal
possui uma caracterísitca bastante interessante. Se aplicarmos uma
transformação linear numa variável normalmente distribuída, a nova
variável continua sendo normalmente distribuída, porém com diferentes
valores para os parâmetros da distribuição.</p>
<p>Uma transformação bastante útil é aquela em que a variável é
transformada numa variável normal-padrão, usualmente representada pela
letra <span class="math inline">\(Z\)</span>. A variável normal-padrão
<span class="math inline">\(Z\)</span> possui média zero e variância
unitária, <span class="math inline">\(Z \sim N(0,1)\)</span>. Qualquer
variável que possui distribuiçao Normal pode ser transformada numa
variável normal-padrão, bastando subtrair sua média e dividir pelo seu
desvio-padrão,</p>
<p><span class="math display">\[
Z = \frac{Y-\mu_Y}{\sigma_Y}\sim N(0,1)
\]</span></p>
<p>Essa transformação é bastate útil aqui, pois utilizaremos o quantil
da variável normal-padrão, <span class="math inline">\(Z_p\)</span>,
para escrever o quantil de <span class="math inline">\(Y\)</span>, <span
class="math inline">\(Y_p\)</span>, e também o quantil de cheia, <span
class="math inline">\(Q_p\)</span>.</p>
<p>Quantil de uma variável aleatória, para quem não se lembra, é o valor
da variável associado a uma dada probabilidade de não-excedência. Por
exemplo, por definição, a probabilidade da variável aleatória <span
class="math inline">\(X\)</span> ser menor ou igual ao quantil <span
class="math inline">\(x_p\)</span> é igual a p,</p>
<p><span class="math display">\[
P(X\le x_p)=p
\]</span> Portanto, a probabilidade da variável normal-padrão, <span
class="math inline">\(Z\)</span>, ser menor do que os quantis <span
class="math inline">\(Z_{0.10}\)</span>, <span
class="math inline">\(Z_{0.50}\)</span> e <span
class="math inline">\(Z_{0.90}\)</span> é, respectivamente, 0.10, 0.50 e
0.90.</p>
<p>Como <span class="math inline">\(Z = (Y-\mu_Y)/\sigma_Y\)</span>,
podemos dizer que <span class="math inline">\(Z_p =
(Y_p-\mu_Y)/\sigma_Y\)</span>, de forma que</p>
<p><span class="math display">\[
Y_p = \mu_Y + Z_p\sigma_Y
\]</span> E como <span class="math inline">\(Y=ln(Q)\)</span>, podemos
afirmar que</p>
<p><span class="math display">\[
Q_p = exp(\mu_Y + Z_p\sigma_Y)
\]</span> em que <span class="math inline">\(Q_p\)</span> é o quantil
populacional da variável aleatória <span
class="math inline">\(Q\)</span>, que representa as vazões máximas
anuais. Da mesma for que <span class="math inline">\(\mu_y\)</span> e
<span class="math inline">\(\sigma_Y\)</span> são desconhecidos, <span
class="math inline">\(Q_p\)</span> também é. A única maneira de estimar
<span class="math inline">\(Q_p\)</span> é por meio das estimativas de
<span class="math inline">\(\mu_Y\)</span> e de <span
class="math inline">\(\sigma_Y\)</span>.</p>
<h3 id="método-de-ajuste">Método de ajuste</h3>
<p>Existem diversos métodos para ajustar uma distribuição teórica de
probabilidades aos dados que se tem em mãos. Para o caso da distribuição
lognormal com 2 parâmetros, sabe-se que a forma mais eficiente de
estimar os parâmetros <span class="math inline">\(\mu_Y\)</span> e <span
class="math inline">\(\sigma_Y^2\)</span> é por meio do método dos
momentos, que será explicado na sequência.</p>
<p>Com base numa série de vazões máximas anuais <span
class="math inline">\(\{Q_1,Q_2,\ldots,Q_n\}\)</span>, determinamos uma
nova série com base no logarítmos da série original, <span
class="math inline">\(Y = \{Y_1,Y_2,\ldots,Y_n\}\)</span>.</p>
<p>Em seguida, aplicamos o métodos dos momentos para estimar <span
class="math inline">\(\mu_Y,\sigma_Y^2\)</span>, o que consiste em igual
esses parâmetros aos seus valores amostrias, ou seja,</p>
<p><span class="math display">\[
\hat{\mu}_Y = \bar{Y} = \frac{\sum_1^n y_i}{n}
\]</span> e</p>
<p><span class="math display">\[
\hat{\sigma}_Y^2 = \frac{\sum_{i=1}^n (y_i - \bar{Y})^2}{n-1}
\]</span> Vale notar mais uma vez que <span
class="math inline">\(\hat{\mu}_Y\)</span> e <span
class="math inline">\(\hat{\sigma}_Y^2\)</span> possuem um acento
circunflexo para indicar que eles são os estimadores amostrais dos
parâmetros populacionais <span class="math inline">\(\mu_Y\)</span> e
<span class="math inline">\(\sigma_Y^2\)</span>.</p>
<p>Com os valores de <span class="math inline">\(\hat{\mu}_Y\)</span> e
<span class="math inline">\(\hat{\sigma}_Y^2\)</span>, podemos estimar
os quantis de <span class="math inline">\(Y\)</span> e de <span
class="math inline">\(Q\)</span>,</p>
<p><span class="math display">\[
\hat{Y}_p = \hat{\mu}_Y + Z_p\hat{\sigma}_Y
\]</span> e</p>
<p><span class="math display">\[
\hat{Q}_p = exp(\hat{\mu}_Y + Z_p\hat{\sigma}_Y)
\]</span></p>
<h3 id="ajuste-da-lognormal-e-estimativa-dos-quantis">Ajuste da
lognormal e estimativa dos quantis</h3>
<p>Então, vamos ao que interessa. Temos basicamente que realizar três
etapas para determinar os quantis de cheia com base na distribuição
lognormal,</p>
<ol type="1">
<li>Construir a série <span class="math inline">\(Y =
ln(Q)=\{Y_1,Y_2,\ldots,Q_n\}\)</span></li>
<li>Estimar os parâmetros <span class="math inline">\(\mu_y\)</span> e
<span class="math inline">\(\sigma_Y^2\)</span> por meio dos estimadores
<span class="math inline">\(\hat{\mu}_Y\)</span> e <span
class="math inline">\(\hat{\sigma}_Y^2\)</span></li>
<li>Estimar os quantis de cheia, <span
class="math inline">\(Q_p\)</span>, por meio do estimador <span
class="math inline">\(\hat{Q}_p = exp(\hat{\mu}_Y +
Z_p\hat{\sigma}_Y)\)</span></li>
</ol>
<p>O código para realizar esse ajuste segue abaixo,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Determinar a nova série Y = ln(Q)</span></span>
<span><span class='va'>Q_max_ord</span><span class='op'>$</span><span class='va'>Y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>Q_max_ord</span><span class='op'>$</span><span class='va'>maxima</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Estimar os parâmetros da distribuição Normal, sabendo que Y ~ N(mu_y,sigma2_Y)</span></span>
<span><span class='va'>mu_Y_hat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Q_max_ord</span><span class='op'>$</span><span class='va'>Y</span><span class='op'>)</span></span>
<span><span class='va'>sigma2_hat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>Q_max_ord</span><span class='op'>$</span><span class='va'>Y</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Estimar os quantis de Y e de Q</span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fl'>0.01</span>,to <span class='op'>=</span> <span class='fl'>0.99</span>,by <span class='op'>=</span> <span class='fl'>0.01</span><span class='op'>)</span>     <span class='co'># define valores de p que serão empregados para os quantis</span></span>
<span><span class='va'>Tr</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='va'>p</span><span class='op'>)</span>                                 <span class='co'># Calcula os tempos de recorrência para cada valro de p</span></span>
<span><span class='va'>z_p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span><span class='op'>(</span><span class='va'>p</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>                         <span class='co'># quantil da normal-padrão</span></span>
<span><span class='va'>y_p_hat</span> <span class='op'>&lt;-</span> <span class='va'>mu_Y_hat</span> <span class='op'>+</span> <span class='va'>z_p</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>sigma2_hat</span><span class='op'>)</span>    <span class='co'># estimativa do quantil de Y</span></span>
<span><span class='va'>q_p_hat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>y_p_hat</span><span class='op'>)</span>                       <span class='co'># estimativa do quantil de Q</span></span>
<span></span>
<span><span class='co'># Criação de um dataframe com os quantis de cheia</span></span>
<span><span class='va'>Quantis_Q</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>q_p_hat</span>,<span class='va'>Tr</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Podemos dar uma espiada no dataframe que contém os quantis de cheia
utilizando a função <code>head(dataframe.name)</code>,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>Quantis_Q</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>   q_p_hat       Tr
1 3.603989 1.010101
2 4.101790 1.020408
3 4.452708 1.030928
4 4.736340 1.041667
5 4.980326 1.052632
6 5.197874 1.063830</code></pre>
</div>
<p>Podemos perceber que os seis primeiros valores dos quantis estimados
não são tão interessantes, pois eles estão associados a tempos de
recorrência muito baixos. Existe uma outra função no função no
<code>R</code> que permite espiar a parte final do dataframe, ao invés
da parte inicial. Essa função é chamada de
<code>tail(dataframe.name)</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>Quantis_Q</span>,<span class='fl'>5</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>    q_p_hat        Tr
95 23.73313  20.00000
96 24.95571  25.00000
97 26.54536  33.33333
98 28.81638  50.00000
99 32.79664 100.00000</code></pre>
</div>
<p>O número <code>5</code> no código acima serve para especificar
quantas linhas eu estou interessado em ver.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Q_max_ord</span><span class='op'>$</span><span class='va'>Tr</span>,<span class='va'>Q_max_ord</span><span class='op'>$</span><span class='va'>maxima</span>,type <span class='op'>=</span> <span class='st'>"p"</span>, pch <span class='op'>=</span> <span class='fl'>19</span>,cex <span class='op'>=</span> <span class='fl'>1.5</span>,col <span class='op'>=</span> <span class='st'>"blue"</span>,</span>
<span>     log <span class='op'>=</span> <span class='st'>"x"</span>,main <span class='op'>=</span> <span class='st'>"Curva de frequência de cheias - 60435000"</span>,</span>
<span>     xlab <span class='op'>=</span> <span class='st'>"Tr (anos)"</span>,ylab <span class='op'>=</span> <span class='st'>"Q_max (m3/s)"</span>,</span>
<span>     xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>100</span><span class='op'>)</span>,   <span class='co'># X-axis limits</span></span>
<span>     ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Adiciona a LN2</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>Quantis_Q</span><span class='op'>$</span><span class='va'>Tr</span>,<span class='va'>Quantis_Q</span><span class='op'>$</span><span class='va'>q_p_hat</span>,</span>
<span>      col <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>      lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Adiciona grid horizontal</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/axis.html'>axis</a></span><span class='op'>(</span><span class='fl'>1</span>, at <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>10</span>,by<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>100</span>,by<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>200</span>,<span class='fl'>1000</span>,by<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>     tck <span class='op'>=</span> <span class='fl'>1</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='st'>"gray"</span><span class='op'>)</span></span>
<span><span class='co'># Adiciona grid vertical</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/axis.html'>axis</a></span><span class='op'>(</span><span class='fl'>2</span>, tck <span class='op'>=</span> <span class='fl'>1</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='st'>"gray"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="frequency_analysis_files/figure-html5/unnamed-chunk-13-1.png" width="768" /></p>
</div>
<h3 id="determinação-dos-quantis-de-cheia">Determinação dos quantis de
cheia</h3>
<h2 id="descrição-das-incertezas">Descrição das incertezas</h2>
<p>Quando realizamos uma análise de frequência, além da estimativa dos
quantis de cheia, precisamos ter uma ideia doo quão confiantes estamos
em relação aos valores estimados. Sendo assim, precisamos entender como
calcular a precisão dessas estimativas.</p>
<p>Normalmente, a maneira que empregamos para descrever as incertezas
nas estiamtovas dos quantis de cheias é por meio de intervalos de
confiança.Neste nosso exercício aqui, aprenderemos como calcular
intervalos de confiança associados à distribuição lognormal, que é a
distribuição que está sendo utilizados por nós para construir a curva de
frequência.</p>
<p>Existem duas maneiras de se calcular intervaloes de confiança para a
distribuição lognormal,</p>
<ul>
<li>intervalos aproximados</li>
<li>intervalos exatos</li>
</ul>
<p>Aqui aprenderemos como determinar intervalos de confiança aproximados
para os quantis de cheia oriundos da distribuição lognormal.</p>
<h3
id="lógica-da-construção-de-intervalos-de-confiança-aproximados">Lógica
da construção de intervalos de confiança aproximados</h3>
<p>Suponha que tenhamos uma estimador qualquer denominado <span
class="math inline">\(\hat{W}_p\)</span>. Estou usando a variável <span
class="math inline">\(W\)</span> apenas para reforçar a ideia de que não
precisa ser aquele estimador apresentado anteriormente, que chamamos de
<span class="math inline">\(\hat{Q}_p\)</span>, embora possa ser.</p>
<p>Para a quase totalidade de possíveis estimadores, quando <span
class="math inline">\(n\rightarrow \infty\)</span>, ou em outras
palavras, à medida que a amostra aumenta e passa a ter um número bem
grande de observações, esses estimadores tendem a ter uma distribuição
Normal. Como um estimador depende da amostra que se tem em mãos, ele é
também uma variável aleatória. E como toda variável aleatória, seu
comportamento pode se descrito por uma distribuição teórica de
probabilidades.</p>
<p>Bem, se <span class="math inline">\(\hat{W}_p\)</span> possui
distribuição Normal e variância <span
class="math inline">\(V(\hat{W}_p)\)</span>, então</p>
<p><span class="math display">\[
Z = \frac{\hat{W}_p-E[\hat{W}_p]}{\sqrt{V(\hat{W}_p)}}
\]</span> Como <span class="math inline">\(Z\sim N(0,1)\)</span>,
podemos afirmar que</p>
<p><span class="math display">\[
P(z_{\alpha/2}\le Z \le z_{1-\alpha/2}) = \alpha
\]</span> Se substituirmos <span class="math inline">\(Z\)</span> da
equação acima pela equação anterior, obtemos</p>
<p><span class="math display">\[
P\Bigg(z_{\alpha/2}\le
\frac{\hat{W}_p-E[\hat{W}_p]}{\sqrt{V(\hat{W}_p)}} \le
z_{1-\alpha/2}\Bigg) = \alpha
\]</span> Depois de algumas manipulações algébricas, e admitindo que o
estimador _p é não-tendencioso, o que significa dizer que <span
class="math inline">\(E[\hat{W}_p]=W_p\)</span>, chegamos à afirmação
abaixo,</p>
<p><span class="math display">\[
P\Bigg(\hat{W}_p - z_{1-\alpha/2}\sqrt{V(\hat{W}_p)} \le W_p \le
\hat{W}_p + z_{1-\alpha/2}\sqrt{V(\hat{W}_p)}\Bigg) = \alpha
\]</span> que em bom português diz que a probabilidade do valor
populacional de <span class="math inline">\(W_p\)</span> estar entre
esses dois limites, <span class="math inline">\(\hat{W}_p \pm
z_{1-\alpha/2}\sqrt{V(\hat{W}_p)}\)</span> é igual à <span
class="math inline">\(\alpha\)</span>. É essa afirmação matemática que
nos permite estabelecer o intervalo de confiança de <span
class="math inline">\(100(1-\alpha)\%\)</span> para <span
class="math inline">\(W_p\)</span>, apresentado abaixo,</p>
<p><span class="math display">\[
\Bigg[\hat{W}_p - z_{1-\alpha/2}\sqrt{V(\hat{W}_p)};\hat{W}_p +
z_{1-\alpha/2}\sqrt{V(\hat{W}_p)}\Bigg]
\]</span></p>
<p>Sendo assim, podemos construir o intervalo de confiança aproximado de
<span class="math inline">\(Y_p=ln(Q_p)\)</span> e de <span
class="math inline">\(Q_p\)</span>, que é o que de fato nos
interessa.</p>
<p>Primeiro, constuímos o intervalo de confiança aproximado de <span
class="math inline">\(Y_p\)</span>,</p>
<p><span class="math display">\[
\Bigg[\hat{Y}_p - z_{1-\alpha/2}\sqrt{V(\hat{Y}_p)};\hat{Y}_p +
z_{1-\alpha/2}\sqrt{V(\hat{Y}_p)}\Bigg]
\]</span></p>
<p>O problema aqui é que ainda precisamos saber quem é <span
class="math inline">\(V(\hat{Y}_p)\)</span>. Este não é um curso de
estatística, mas sim de <code>R</code> aplicado à Hidrologia. Por isso,
deixarei a explicação de como determinar <span
class="math inline">\(V(\hat{Y}_p)\)</span> num local separado,</p>
<div class="infobox tip">
<p>There is a lot of information within this practical book and
<strong>we do not expect you to read everything we link to</strong>. You
should attend each lecture, go through every practical and do some
associated reading.</p>
<p>This is a 15 credit module, equivalent to 150 hours of study
(including the taught sessions). Outside of our lectures and practical
sessions (3 hours a week) <strong>you should be spending an extra 12
hours a week on this module</strong>.</p>
<p><span class="math display">\[
\begin{align}
V(\hat{Y}_p) &amp;= V(\hat{\mu}_y + z_p\hat{\sigma}_Y)\\
             &amp;= V(\hat{\mu}_y) + V(z_p\hat{\sigma}_Y)\\
             &amp;= V(\hat{\mu}_y) + z_p^2V(\hat{\sigma}_Y)\\
             &amp;= \frac{\hat{\sigma}_Y^2}{n} + z_p^2V(\hat{\sigma}_Y)
\end{align}
\]</span></p>
</div>
<p><span class="math display">\[
\begin{align}
V(\hat{Y}_p) &amp;= V(\hat{\mu}_y + z_p\hat{\sigma}_Y)\\
             &amp;= V(\hat{\mu}_y) + V(z_p\hat{\sigma}_Y)\\
             &amp;= V(\hat{\mu}_y) + z_p^2V(\hat{\sigma}_Y)\\
             &amp;= \frac{\hat{\sigma}_Y^2}{n} + z_p^2V(\hat{\sigma}_Y)
\end{align}
\]</span> Pode-se mostrar que <span
class="math inline">\(V(\sigma_Y)\approx \hat{\sigma}_Y^2/(2n)\)</span>,
o que resulta na seguinte expressão para <span
class="math inline">\(V(\hat{Y}_p)\)</span>,</p>
<p><span class="math display">\[
V(\hat{Y}_p) \approx
\frac{\hat{\sigma}_Y^2}{n}\Bigg(1+\frac{1}{2}Z_p^2\Bigg)
\]</span></p>
<p>Dessa forma, o intervalo de confiança de <span
class="math inline">\(100(1-\alpha)\%\)</span> para <span
class="math inline">\(Y_p\)</span> pode ser descrito como</p>
<p><span class="math display">\[
\Bigg[\hat{Y}_p -
z_{1-\alpha/2}\sqrt{\frac{\hat{\sigma}_Y^2}{n}\Bigg(1+\frac{1}{2}Z_p^2\Bigg)};\hat{Y}_p
+
z_{1-\alpha/2}\sqrt{\frac{\hat{\sigma}_Y^2}{n}\Bigg(1+\frac{1}{2}Z_p^2\Bigg)}\Bigg]
\]</span></p>
<p>Para determinar o o intervalo de confiança de <span
class="math inline">\(100(1-\alpha)\%\)</span> para <span
class="math inline">\(Q_p\)</span>, basta exponenciar o intervalo
acima,</p>
<p><span class="math display">\[
\begin{align}
IC_{(1-\alpha)}(Q_p) &amp;= exp\Bigg[\hat{Y}_p \pm
z_{1-\alpha/2}\sqrt{\frac{\hat{\sigma}_Y^2}{n}\Bigg(1+\frac{1}{2}Z_p^2\Bigg)}\Bigg]\\
               &amp;= exp\Bigg[(\hat{\mu}_Y+z_p\hat{\sigma}_y) \pm
z_{1-\alpha/2}\sqrt{\frac{\hat{\sigma}_Y^2}{n}\Bigg(1+\frac{1}{2}Z_p^2\Bigg)}\Bigg]
\end{align}
\]</span></p>
<p>Por exemplo, suponha que queiramos estabelecer o intervalo de
confiança de 95% para o quantil <span
class="math inline">\(Q_99\)</span>, equivalente à cheia de 100 anos de
recorrência. Nesse caso, <span class="math inline">\(\alpha =
0.05\)</span> e <span class="math inline">\(p=0.99\)</span>, o que leva
a seguinte intervalo de confiança,</p>
<p><span class="math display">\[
\begin{align}
IC_{.95}(Q_{0.99}) &amp;= exp\Bigg[(\hat{\mu}_Y+z_{.99}\hat{\sigma}_y)
\pm
z_{.975}\sqrt{\frac{\hat{\sigma}_Y^2}{n}\Bigg(1+\frac{1}{2}Z_{.99}^2\Bigg)}\Bigg]\\
                    &amp;=exp\Bigg[(\hat{\mu}_Y+2.326\hat{\sigma}_y) \pm
1.96\sqrt{\frac{\hat{\sigma}_Y^2}{n}\Bigg(1+\frac{1}{2}2.326^2\Bigg)}\Bigg]
\end{align}
\]</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>alpha</span> <span class='op'>&lt;-</span> <span class='fl'>0.05</span></span>
<span><span class='va'>var_yp</span> <span class='op'>&lt;-</span> <span class='va'>sigma2_hat</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>Q_max_ord</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='va'>z_p</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>lower_IC</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>mu_Y_hat</span> <span class='op'>+</span> <span class='va'>z_p</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>sigma2_hat</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='va'>alpha</span><span class='op'>/</span><span class='fl'>2</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>var_yp</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>upper_IC</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>mu_Y_hat</span> <span class='op'>+</span> <span class='va'>z_p</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>sigma2_hat</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='va'>alpha</span><span class='op'>/</span><span class='fl'>2</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>var_yp</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Q_max_ord</span><span class='op'>$</span><span class='va'>Tr</span>,<span class='va'>Q_max_ord</span><span class='op'>$</span><span class='va'>maxima</span>,type <span class='op'>=</span> <span class='st'>"p"</span>,           <span class='co'># plota apenas pontos</span></span>
<span>     pch <span class='op'>=</span> <span class='fl'>19</span>,col <span class='op'>=</span> <span class='st'>"blue"</span>, cex <span class='op'>=</span> <span class='fl'>1.5</span>,                   <span class='co'># círculos azuis de tamanho 1.5 </span></span>
<span>     log <span class='op'>=</span> <span class='st'>"x"</span>,                                          <span class='co'># escala logaritmica no eixo-x</span></span>
<span>     main <span class='op'>=</span> <span class='st'>"Curva de frequência de cheias - 60435000"</span>,  <span class='co'># título </span></span>
<span>     xlab <span class='op'>=</span> <span class='st'>"Tr (anos)"</span>,ylab <span class='op'>=</span> <span class='st'>"Q_max (m3/s)"</span>,           <span class='co'># nome dos eixos</span></span>
<span>     xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>100</span><span class='op'>)</span>,                                   <span class='co'># limites od eixo-x              </span></span>
<span>     ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span>                                    <span class='co'># limites do eixo-y</span></span>
<span></span>
<span><span class='co'># Adiciona a LN2</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>Quantis_Q</span><span class='op'>$</span><span class='va'>Tr</span>,<span class='va'>Quantis_Q</span><span class='op'>$</span><span class='va'>q_p_hat</span>,</span>
<span>      col <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>      lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Adiciona IC</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>Quantis_Q</span><span class='op'>$</span><span class='va'>Tr</span>,<span class='va'>lower_IC</span>,</span>
<span>      col <span class='op'>=</span> <span class='st'>"red"</span>,lty <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>      lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>Quantis_Q</span><span class='op'>$</span><span class='va'>Tr</span>,<span class='va'>upper_IC</span>,</span>
<span>      col <span class='op'>=</span> <span class='st'>"red"</span>,lty <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>      lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Adiciona grid horizontal</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/axis.html'>axis</a></span><span class='op'>(</span><span class='fl'>1</span>, at <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>10</span>,by<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>100</span>,by<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>200</span>,<span class='fl'>1000</span>,by<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>     tck <span class='op'>=</span> <span class='fl'>1</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='st'>"gray"</span><span class='op'>)</span></span>
<span><span class='co'># Adiciona grid vertical</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/axis.html'>axis</a></span><span class='op'>(</span><span class='fl'>2</span>, tck <span class='op'>=</span> <span class='fl'>1</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='st'>"gray"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="frequency_analysis_files/figure-html5/unnamed-chunk-15-1.png" width="960" /></p>
</div>
<h2 id="inferência">Inferência</h2>
<h3 id="cálculo-dos-momentos-l">Cálculo dos momentos-L</h3>
<h3 id="diagrama-de-momentos-l">Diagrama de momentos-L</h3>
<h3 id="estimativa-dos-parâmetros-da-distribuição">Estimativa dos
parâmetros da distribuição</h3>
<h3 id="cálculo-dos-quantis-de-cheia">Cálculo dos quantis de cheia</h3>
<h2 id="construção-da-curva-de-frequência">Construção da curva de
frequência</h2>
<h2 id="descrição-das-incertezas-intervalo-de-confiança">Descrição das
incertezas (intervalo de confiança)</h2>
<h2 id="curva-de-frequência-final">Curva de frequência final</h2>
<h2 id="detalhes-técnicos">Detalhes técnicos</h2>
<h3 id="distribuição-de-probabilidades">Distribuição de
probabilidades</h3>
<h4 id="para-que-servem">Para que servem?</h4>
<p>O uso de uma distribuição teórica de probabilidades se justifica por
três motivos,</p>
<ul>
<li>permite a extrapolação da curva, ou seja, torna possível a
estimativa de uma vazão com 50 anos tempo de retorno mesmo quando temos
apenas 20 anos de dados;</li>
<li>pode ser utilizada como um interpolador de quantis de cheia, já que
o uso da frequência amostral só permite estimar quantis para um número
discreto, e nem sempre desejado, de períodos de retorno.</li>
<li>é uma maneira de armazenar as infomações relevantes da série de
máximos de maneira compacta, visto que basta guardar o valor dos
parâmetro da distribuição para obter qualquer quantil de cheia que se
tenha interesse.</li>
</ul>
<h2 id="detalhamento-de-posição-de-plotagem">Detalhamento de posição de
plotagem</h2>
<p>Embora não seja o objetivo aqui deste curso entender os detalhes
deste procedimento, mas vale a pena dizer o seguinte: como a
distribuição empírica de frequência depende da amostra que se tem em
mãos, ela é na verdade uma variável aleatória, ou seja, ela pode variar
de amostra para amostra, de modo que é razoável imaginar que ela possui
uma distribuição de probabilidades.</p>
<p>Suponha que fosse possível obter diversas amostras independentes da
variável de interesse, todas de tamanho <span
class="math inline">\(n\)</span> e oriundas de uma mesma distribuição de
probabilidades. Vale lembrar que na prática apenas uma amostra está
disponível. Embora não seja apresentado aqui o porquê, é possível
mostrar que a probabilidade de não-excedência da estatística de ordem
$X_{(i)}, <span class="math inline">\(Q_i = P(X \gt x_{(i)})\)</span> é
também uma variável aleatória, pois depende da amostra. A distribuição
de <span class="math inline">\(Q_i\)</span> é uma Beta (i.e., possui uma
distribuição Beta) com valor esperado</p>
<p><span class="math display">\[E[Q_i] = \frac{i}{n + 1}\]</span></p>
<p>e variância</p>
<p><span class="math display">\[V[Q_i] =
\frac{n-i+1}{(n+1)^2(n+2)}\]</span> independetente da dsitribuiçao da
variável de interesse.</p>
<p>Isso significa, por exemplo, que numa amostra com 19 observações, o
valor esperado da probabilididade da variável de interesse ser maior do
que a segunda maior observação da referida amostra, <span
class="math inline">\(Q_{(2)}\)</span>, é igual a</p>
<p><span
class="math display">\[E[Q_{(2)}]=\frac{2}{20}=0.10\]</span></p>
<p>da mesma forma que o valor esperado da probabilididade da variável de
interesse ser maior do que a maior observação da referida amostra, <span
class="math inline">\(Q_{(1)}\)</span>, é igual a</p>
<p><span
class="math display">\[E[Q_{(1)}]=\frac{1}{20}=0.05\]</span></p>
<p>Podemos concluir, portanto, que se estimarmos <span
class="math inline">\(F_X(x_{(i)})\)</span> utilizando a expressão <span
class="math inline">\(i/(n+1)\)</span>, em média, utilizando várias
amostras, a média das estimativas de <span
class="math inline">\(F_X(x_{(i)})\)</span> seria bem próxima do valor
populacional, e o grau de proximidade aumenta com o tamanho da
amostra.</p>
<p>Porém, é importanter deixar claro que quando há apenas uma amostra,
não é possível ter certeza de que a estimativa é correta, mas é
intuitivo pensar que um estimador, que em média está correto, é de fato
um bom estimador. Mais à frente na aula, retornaremos à discussão sobre
estimadores e suas características. Mas vale introduzir o conceito de
estimador não tendencioso, que é aquele que na média, ao longo de várias
amostras, seu valor é igual ao valor populacional.</p>
<p>Portanto, por se tratar de um estimador não-tendencioso da
probabilidade de não-excedência da estatística de ordem de uma amostra,
a expressão apresentada anteriormente é uma forte candidata a ser
utilizada na construção da curva de distribuição empírica de frequência.
Porém, como já mencionado anteriormente, há outras formas de se estimar
<span class="math inline">\(F_X(x_{(i)})\)</span>, sendo que todas
seguem a seguinte expressão, com diferença apenas para o valor do
parâmetro <span class="math inline">\(a\)</span>.</p>
<p><span class="math display">\[P(X \lt x_{(i)}) =
\frac{i-a}{n+1-2a}\]</span></p>
<p>A Tabela abaixo apresenta diversas expressões para o estimador de
<span class="math inline">\(F_X(x_{(i)})\)</span>, incluindo a motivação
de cada alternativa.</p>
<table>
<colgroup>
<col style="width: 13%" />
<col style="width: 23%" />
<col style="width: 13%" />
<col style="width: 18%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="header">
<th>Nome</th>
<th>Fórmula</th>
<th><span class="math inline">\(a\)</span></th>
<th><span class="math inline">\(T_n\)</span></th>
<th>Motivação</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Weibull</td>
<td><span class="math inline">\(\frac{i}{n+1}\)</span></td>
<td>0</td>
<td><span class="math inline">\(n+1\)</span></td>
<td>Est. não-tendenciosa da Prob. de não-excedência para qualquer
distribuição teórica</td>
</tr>
<tr class="even">
<td>Mediana</td>
<td><span class="math inline">\(\frac{i-0.3175}{n+0.365}\)</span></td>
<td>0.3175</td>
<td><span class="math inline">\(1.47n+0.5\)</span></td>
<td>Mediana das probabilidades</td>
</tr>
<tr class="odd">
<td>APL</td>
<td><span class="math inline">\(\frac{i-0.35}{n}\)</span></td>
<td><span class="math inline">\(~0.35\)</span></td>
<td><span class="math inline">\(1.54n\)</span></td>
<td>Estimador baseado em momentos probabilísticos</td>
</tr>
<tr class="even">
<td>Blom</td>
<td><span class="math inline">\(\frac{i-3/8}{n+1/4}\)</span></td>
<td>0.375</td>
<td><span class="math inline">\(1.60n+0.4\)</span></td>
<td>Quantis normais não-tendenciosos</td>
</tr>
<tr class="odd">
<td>Cunnane</td>
<td><span class="math inline">\(\frac{i-0.40}{n+0.2}\)</span></td>
<td>0.40</td>
<td><span class="math inline">\(1.67n+0.3\)</span></td>
<td>Quantis aproximadamente não-tendenciosos</td>
</tr>
<tr class="even">
<td>Grigorten</td>
<td><span class="math inline">\(\frac{i-0.44}{n+0.12}\)</span></td>
<td>0.44</td>
<td><span class="math inline">\(1.79n+0.2\)</span></td>
<td>Otimizada para distribuição Gumbel</td>
</tr>
<tr class="odd">
<td>Hazen</td>
<td><span class="math inline">\(\frac{i-0.5}{n}\)</span></td>
<td>0.50</td>
<td><span class="math inline">\(2n\)</span></td>
<td>Escolha tradicional</td>
</tr>
</tbody>
</table>
<h4 id="quais-são-as-distribuições-mais-usadas">Quais são as
distribuições mais usadas?</h4>
<h4 id="como-avaliar-a-distribuição-mais-indicada">Como avaliar a
distribuição mais indicada?</h4>
<h4 id="ajuste-dos-parâmetros-da-distribuição">Ajuste dos parâmetros da
distribuição</h4>
<h4 id="estimativa-dos-quantis-de-cheia">Estimativa dos quantis de
cheia</h4>
<h4 id="descrição-das-incertezas-1">Descrição das incertezas</h4>
<h2 id="passos-a-serem-executados">Passos a serem executados</h2>
<ul>
<li>Visualizar os dados
<ul>
<li>Escolha da estação fluviométrica</li>
<li>Obtenção da série de máximos anuais</li>
<li>Cálculo das posições de plotagem</li>
<li>Construção de figura utilizando valores amostrais apenas</li>
</ul></li>
<li>Inferência
<ul>
<li>Cálculo dos momentos-L para fins de verificação da distribuição
teórica de probabilidades</li>
<li>Plotagem do diagrama de momentos-L das distribuições teóricas</li>
<li>Ajuste dos parâmetros da distribuição teórica de probabilidades
<ul>
<li>Lognormal</li>
<li>Generalizada de valores extremos</li>
</ul></li>
<li>Cálculo dos quantis de cheia<br />
</li>
</ul></li>
<li>Curva de frequência sem incertezas</li>
<li>Estimativa dos intervalos de confiança para a distribuição
Lognormal</li>
<li>Curva de frequência com intervalos de confiança</li>
</ul>
<div class="sourceCode" id="cb9"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="updates-and-corrections">Corrections</h3>
<p>If you see mistakes or want to suggest changes, please <a href="https://github.com/DirceuReis/Mini_Curso_UnB_SemUniv_AnaliseHidro_R/issues/new">create an issue</a> on the source repository.</p>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/DirceuReis/Mini_Curso_UnB_SemUniv_AnaliseHidro_R">https://github.com/DirceuReis/Mini_Curso_UnB_SemUniv_AnaliseHidro_R</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
